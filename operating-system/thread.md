# 스레드
현대 운영체제의 대부분은 하나의 프로세스가 여러 스레드를 포함한다.

- 스레드는 thread id, 프로그램 카운터, 레지스터 집합, 그리고 스택으로 구성된다.
- 스레드는 같은 프로세스에 속한 다른 스레드와 코드, 데이터, 파일이나 신호같은 OS 자원 들을 공유한다.

## 왜 스레드 개념이 등장했는가?
웹 서버를 예로 들면 요청이 들어올 경우 프로세스는 해당 요청을 수행할 별도의 프로세스를 만드는 방식이었다.
그러나 프로세스를 생성하는 것은 오버헤드가 있는 작업이다. 새로운 프로세스가 기존 프로세스와 동일하다면, 프로세스 안에 여러 스레드를 만드는것이 더 효율적이기 때문이다.

## Multithreading model
스레드는 `사용자 스레드(user thread)` 와 `커널 스레드(kernel thread)` 로 나누어진다.

- 사용자 스레드는 커널위에서 지원되며 커널의 자원 없이 관리되고
- 커널 스레드는 운영체제에 의해 지원되고 관리된다.

### Many-to-one model
하나의 커널 스레드가 여러 사용자 스레드를 만드는 것이다.

#### 단점
하지만 하나의 사용자 스레드가 blocking call 을 하면 전체 프로세스가 block 되기 때문에 효율적이지 못하다.

`green thread` 가 이 모델을 사용했는데 초기 자바도 이걸 사용했다.
그러나 현재는 이점이 없어서 거의 사용되지 않는다고 한다.

### One-to-one model
하나의 커널 스레드가 하나의 사용자 스레드를 만드는 것이다. (책에서는 사상된다고 하는데 말이 좀 어려운 것 같다.)

#### 단점
단점은 사용자 스레드를 생성할 때 마다 커널 스레드가 생성되서 그만큼 오버헤드가 발생하여 시스템의 성능을 저하시킬 수 있다는 것이다.

### Many-to-many model


### 그림 참고
https://docs.oracle.com/cd/E19620-01/805-4031/6j3qv1oej/index.html
https://www.javatpoint.com/multithreading-models-in-operating-system

## 리눅스에서의 스레드
사실 리눅스는 프로세스와 스레드를 구별하지 않는다. 그냥 `task` 라고 부르고 스레드를 생성할 떄 `clone` 이라는 함수를 사용하기도 한다.

